{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block javascript %}
<script>
$(function(){
    var dtToday = new Date();
    var month = dtToday.getMonth() + 1;
    var day = dtToday.getDate()+1;
    var year = dtToday.getFullYear();
    if(month < 10)
        month = '0' + month.toString();
    if(day < 10)
        day = '0' + day.toString();
    
    var maxDate = year + '-' + month + '-' + day;
    // alert(maxDate);
    $('#txtDate').attr('min', maxDate);
    $('#txtDate1').attr('min', maxDate);
});
</script>
{% endblock %}

{% block content %}

<div class='container'>
</br>
<title>{{ title }}</title>
<div class='container'>
    <div class='row'>
        <div class='col-sm-12'>
           <div class='col-sm-8 pull-left'>
           <h1>{{ object.product_name|capfirst }}
          
         </h1> 
         </div>
         <div class='col-sm-4 col-xs-6 pull-right'>
           <form class='form' method='POST' action='{% url "cart:add_to_cart" object.id %}'> {% csrf_token %}
             <input class='btn btn-dark btn-block' type='submit' value='Add to cart' />
              Quantity-: <input class='form-control' name='qty' type='number' value='1' min='1' max='10' />
              Start Date-: 
             <input class='form-control' type="date" name='start_date' required='True' value='start_date' id="txtDate" />
              End Date-: <input class='form-control' type="date" name='end_date' required='True' value='end_date' id="txtDate1" />
             
          {% if object.variation_set.all %}

             {% if object.variation_set.sizes %}
             Size-:
              <select class='form-control' name='size'>
                {% for item in object.variation_set.sizes %}
                <option value='{{ item.title|lower }}'>{{ item.title|capfirst }}</option>
                {% endfor %}
              </select>
              
             {% endif %}
              
              {% if  object.variation_set.colors %}
              Color-:
              <select class='form-control' name='color'>
                {% for item in object.variation_set.colors %}
                <option value='{{ item.title|lower }}'>{{ item.title|capfirst }}</option>
                {% endfor %}
              </select>
              
             {% endif %}


          {% endif %}
           </form>
         </br>
           <!-- <a  href='{% url "cart:home" %}'><button type='submit' class='btn btn-primary'> Go to Cart </button> </a> -->
           <h3> Variations available</h3>
          
             {% for obj in qs %}
             {% if obj.quantity > 5 %}
             <div class='container'>
            <div class='col-12 my-3'>
            {{ forloop.counter }}.
            {% if obj.variations.all %}
            {% for item in obj.variations.all %}
            {{ item.title|capfirst }} {{ item.category|capfirst }}
            {% if not forloop.last %} , {% endif %}
            {% endfor %}
            {% else %}
            as shown in image.
            {% endif %}
            
            </div>
            </div>
             {% else %}
         <div class='container'>
            <div class='col-12 my-3'>
            {{ forloop.counter }}.
            {% if obj.variations.all %}
            {% for item in obj.variations.all %}
            {{ item.title|capfirst }} {{ item.category|capfirst }}
            {% if not forloop.last %} , {% endif %}
            {% endfor %}
            {% else %}
            as shown in image
            {% endif %}
       
            <font color="red">Available Quantity-: {{ obj.quantity }} only </font>
            </div>
            </div>
            {% endif %}
             {% empty %}
            <p class='col-12'>  Sorry no products left yet.</p>
            {% endfor %}
          </div>
         <hr/>
         
            <div class="card" style="width: 18rem">
            {% if object.image %}
            <img src='{{ object.image.url }}' class='img-fluid' />
             {% endif %}  
            </div>
             <!-- {% for img in images %}
             <div class='col-xs-6 col-md-3'>
               <a href="#">
             <img class='img-thumbnail' src='{{ img.image.url }}' />
             </a>
             </div>
             {% endfor %} -->

             <!-- slider -->
                <div class='col-xs-10 col-md-8'  style="width: 20rem; height: 18rem">
                <div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                  <li data-target="#carouselExampleCaptions" data-slide-to="0" class="active"></li>
                  <li data-target="#carouselExampleCaptions" data-slide-to="1"></li>
                  <li data-target="#carouselExampleCaptions" data-slide-to="2"></li>
                </ol>
                <div class="carousel-inner">
                  {% if images0 and images1 and images2 %}
                  <div class="carousel-item active">
                    <img class="img-thumbnail" src='{{ images0.image.url }}' alt="First slide">
                  </div>
                  <div class="carousel-item">
                    <img class="img-thumbnail" src='{{ images1.image.url }}' alt="Second slide">
                  </div>
                  <div class="carousel-item">
                    <img class="img-thumbnail" src='{{ images2.image.url }}' alt="Third slide">
                  </div>
                  {% endif %}
                  

                  {% if images0 and images1 and not images2 %}
                  <div class="carousel-item active">
                    <img class="img-thumbnail" src='{{ images0.image.url }}' alt="First slide">
                  </div>
                  <div class="carousel-item">
                    <img class="img-thumbnail" src='{{ images1.image.url }}' alt="Second slide">
                  </div>
                  {% endif %}
                  

                   {% if images0 and not images1 and not images2 %}
                  <div class="carousel-item active">
                    <img class="img-thumbnail" src='{{ images0.image.url }}' alt="First slide">
                  </div>
                  
                  {% endif %}
              </div>

              <a class="carousel-control-prev" href="#carouselExampleCaptions" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleCaptions" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
          </div>



          <br/>
          
           {{ object.timestamp|timesince }} ago
           <h5>Brand-: {{ object.brand }}</h5>
           
           {% if object.discount_price %}
           <h6> Cost per day-:<strike> ${{ object.cost_per_day }}</strike> ${{ object.discount_price }} ({{ object.get_amount_percent_saved }}% Off)</h6>
           {% else %}
           <h6> Cost per day-: ${{ object.cost_per_day }}</h6>
           {% endif %}
            {{ object.description|linebreaks }}<br/>
       
        
        </div>

     


       
<div class='col-12 col-md-8'>
           
       
      
    
      
    </br>
    <!-- {{ all }} -->


</div>
</div>
</div>
{% if similar_products %}
 <h1>Similar Products</h1>
      </br>
                    <div class='row'>
                    </br>
                {% for object in similar_products %}
                <div class='col'>
                                
                  {{ forloop.counter }}.
                 {% include 'analytics/trending_card.html' with instance=object %}
                </div>
                      
                      
                {% endfor %}

            </div>
    {% endif %}
       



 <h1>Our Customers Rating and Reviews.</h1>
 {% if reviews.exists %}
<table class="table">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">UserName</th>
      <th scope="col">Review</th>
      <th scope="col">Rating</th>
    
      
      
      
    </tr>
  </thead>
  
  <tbody>
   
    {% for rev in reviews %}
      <tr>

    
      <th scope="row">{{ forloop.counter }}</th>
      <td> {{ rev.email.full_name }}
      
      </td>
      <td>{{ rev.review }}</td>
      <td>{{ rev.rating }} out of 5</td>
     
    </tr>
     
    {% endfor %}
   
    


  </tbody>
</table>

{% else %}

<p class='lead'>Not Reviewed yet!</p>
 {% endif %}

</div>

 {% endblock %}

 