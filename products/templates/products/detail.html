{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load static %}
{% block javascript %}
<script>
$(function(){
    var dtToday = new Date(new Date().getTime() + 2 * 24 * 60 * 60 * 1000);
    var dtToday1 = new Date(new Date().getTime() + 9 * 24 * 60 * 60 * 1000);
    var month1 =  dtToday1.getMonth()+1;
    var day1 = dtToday1.getDate();
    var year1 = dtToday1.getFullYear();
    if(month1 < 10)
        month1 = '0' + month1.toString();
    if(day1 < 10)
        day1 = '0' + day1.toString();
    var maxDate1 = year1 + '-' + month1 + '-' + day1;
    $('#txtDate').attr('max', maxDate1);



    var month = dtToday.getMonth()+1;
    var day = dtToday.getDate();
    var year = dtToday.getFullYear();
    if(month < 10)
        month = '0' + month.toString();
    if(day < 10)
        day = '0' + day.toString();
    
    var maxDate = year + '-' + month + '-' + day;
    // alert(maxDate);
    $('#txtDate').attr('min', maxDate);
    $('#txtDate1').attr('min', maxDate);
});



var slideIndex = 1;
showSlides(slideIndex);

// Next/previous controls
function plusSlides(n) {
  showSlides(slideIndex += n);
}

// Thumbnail image controls
function currentSlide(n) {
  showSlides(slideIndex = n);
}

function showSlides(n) {
  var i;
  var slides = document.getElementsByClassName("mySlides");
  var dots = document.getElementsByClassName("demo");
  var captionText = document.getElementById("caption");
  if (n > slides.length) {slideIndex = 1}
  if (n < 1) {slideIndex = slides.length}
  for (i = 0; i < slides.length; i++) {
    slides[i].style.display = "none";
  }
  for (i = 0; i < dots.length; i++) {
    dots[i].className = dots[i].className.replace(" active", "");
  }
  slides[slideIndex-1].style.display = "block";
  dots[slideIndex-1].className += " active";
  captionText.innerHTML = dots[slideIndex-1].alt;
} 



</script>
{% endblock %}

{% block content %}

<div class='container'>
</br>
<style>
             .zoom{
                padding: 10px;
                background-color:rgb(241, 241, 241);;
                transition: transform .2s; /* Animation */
                width: 200px;
                height: 200px;
                margin: 0 auto;
                          }
                .zoom:hover {
                transform: scale(1.4); /* (150% zoom - Note: if the zoom is too large, it will go outside of the viewport) */
              }
              *{
                  box-sizing: border-box;
                }

                /* Position the image container (needed to position the left and right arrows) */
                .container {
                  position: relative;
                }

                /* Hide the images by default */
                .mySlides {
                  display: none;
                }

                /* Add a pointer when hovering over the thumbnail images */
                .cursor {
                  cursor: pointer;
                }

                /* Next & previous buttons */
                .prev,
                .next {
                  cursor: pointer;
                  position: absolute;
                  top: 40%;
                  width: auto;
                  padding: 16px;
                  margin-top: -50px;
                  color: white;
                  font-weight: bold;
                  font-size: 20px;
                  border-radius: 0 3px 3px 0;
                  user-select: none;
                  -webkit-user-select: none;
                }

                /* Position the "next button" to the right */
                .next {
                  right: 0;
                  border-radius: 3px 0 0 3px;
                }

                /* On hover, add a black background color with a little bit see-through */
                .prev:hover,
                .next:hover {
                  background-color: rgba(0, 0, 0, 0.8);
                }

                /* Number text (1/3 etc) */
                .numbertext {
                  color: #000000;
                  font-size: 12px;
                  padding: 8px 12px;
                  position: absolute;
                  top: 0;
                }

                /* Container for image text */
                /* .caption-container {
                  text-align: center;
                  background-color: #222;
                  padding: 2px 16px;
                  color: white;
                } */

                .row:after {
                  content: "";
                  display: table;
                  clear: both;
                }

                /* Six columns side by side */
                .column {
                  float: left;
                  width: 16.66%;
                }

                /* Add a transparency effect for thumnbail images */
                .demo {
                  opacity: 0.6;
                }

                .active,
                .demo:hover {
                  opacity: 1;
                }
             
           </style>
          <title>{{ title }}</title>

              <div class='row'>
                  
                <div class='col-lg-4 col-md-6 col-sm-6' >
                      <br/>
            <h2 class="text-center " style="margin-right: 100px;"> <strong>{{ object.product_name|capfirst }} </strong></h2>
           
           
        
         

              <div class="mySlides">
                <div class="numbertext">1 / 4</div>
                  <img src="{{ object.image.url }}"  class="zoom"   style="margin-left: 30px;  width:20rem; height:20rem !important;" />
              </div>

              <div class="mySlides">
                <div class="numbertext">2 / 4</div>
                  <img src='{{ images0.image.url }}'  class="zoom"   style=" margin-left: 30px; width:20rem; height:20rem !important;" />
              </div>

              <div class="mySlides">
                <div class="numbertext">3 / 4</div>
                  <img src='{{ images1.image.url }}'  class="zoom"   style="margin-left: 30px; width:20rem; height:20rem !important;" />
              </div>

              <div class="mySlides">
                <div class="numbertext">4 / 4</div>
                  <img src='{{ images2.image.url }}'  class="zoom"  style="margin-left: 30px; width:20rem; height:20rem !important;" />
              </div>

              

              <!-- Next and previous buttons -->
             
              <!-- <a class="prev"  onclick="plusSlides(-1)">&#10094;</a>
              <a class="next"  onclick="plusSlides(1)">&#10095;</a> -->
             

              <!-- Image text -->
              <!-- <div class="caption-container">
                <p id="caption"></p>
              </div> -->
              <br/>
              
              <!-- Thumbnail images -->
              <div class="row" style="margin-left: 40px;">
                <div class="column">
                  <img class="demo cursor" src="{{ object.image.url }}" style=" width:80%" onclick="currentSlide(1)" alt="fig.1">
                </div>
                <div class="column">
                  <img class="demo cursor" src="{{ images0.image.url }}" style="width:80%" onclick="currentSlide(2)" alt="fig.2">
                </div>
                <div class="column">
                  <img class="demo cursor" src="{{ images1.image.url }}" style=" width:80%;" onclick="currentSlide(3)" alt="fig.3">
                </div>
                <div class="column">
                  <img class="demo cursor" src="{{ images2.image.url }}" style="width:80%;" onclick="currentSlide(4)" alt="fig.4">
                </div>
                
              </div>
            <br/>
             <div class="text-center" style="background-color: #007b5e; color: white; width:25rem;align-content: center;">
            <h3 class="text-center">About Item</h3>
            
               {{ object.description|linebreaks }}<br/>
             </div>
            </div>

        
        
        <div class='col-sm-4 col-lg-3 col-md-2'>
        
        </div>
        
        
         <div class='col-sm-4 col-lg-5 col-md-4'>
          <br/>
        <br/>
        <br/>
          <div class="card" style="z-index: -1; width: 25rem; background-color:#263238;">
          <div class="card-body text-center" style="color: white;">
            
           <p>Posted : {{ object.timestamp|timesince }} ago   {% if product_time %}
                      <span class="badge badge-pill badge-danger">NEW</span>
            {% endif %}</p>
           
           <h5>Brand : {{ object.brand }}</h5>
           <br/>
           {% if object.discount_price %}
           <h4> Cost : <strike> ${{ object.cost_per_day }}</strike> ${{ object.discount_price }}/day ({{ object.get_amount_percent_saved }}% Off)</h4>
           {% else %}
           <h4> Cost : ${{ object.cost_per_day }}/day</h4>
           {% endif %}
          
        </div>
        </div>
          


        
          <div style=" background-color: lavender; width: 25rem ">
           <form class='form' style="padding: 60px; width:25rem; " method='POST' action='{% url "cart:add_to_cart" object.id %}'> {% csrf_token %}
            
              Quantity-: <input class='form-control' name='qty' type='number' value='1' min='1' max='10' />
              Start Date-:
               <br/>
              <i class="fas fa-calendar-week"></i>
               <input class='form-control' type="date" name='start_date' required='True' value='start_date' id="txtDate" />
          
             
              End Date-: 
              <br/>
              <i class="fas fa-calendar-week"></i>
              <input class='form-control' type="date" name='end_date' required='True' value='end_date' id="txtDate1" />
              
          {% if object.variation_set.all %}

             {% if object.variation_set.sizes %}
             Size-:
              <select class='form-control' name='size'>
                {% for item in object.variation_set.sizes %}
                <option value='{{ item.title|lower }}'>{{ item.title|capfirst }}</option>
                {% endfor %}
              </select>
              
             {% endif %}
              
              {% if  object.variation_set.colors %}
              Color-:
              <select class='form-control' name='color'>
                {% for item in object.variation_set.colors %}
                <option value='{{ item.title|lower }}'>{{ item.title|capfirst }}</option>
                {% endfor %}
              </select>
              
             {% endif %}


          {% endif %}
          <br/>
           <input class='btn btn-light btn-block' style="background-color: #263238;  ; color:white;" type='submit' value='Add to cart' />
           </form>
          </br>
          
           <!-- <a  href='{% url "cart:home" %}'><button type='submit' class='btn btn-primary'> Go to Cart </button> </a> -->
           <h3 class='text-center'> Variations available</h3>
           
            <table class="table" style="background-color: #263238; color: white;">
            <thead>
              <tr>
                <th>#</th>
                <th>Size</th>
                <th>Color</th>
                <th>Quantity</th>
              </tr>
            </thead>
            <tbody>
              
        
     
    

             {% for obj in qs %}
             <tr>
             {% if obj.quantity > 5 %}
           
           
           <td> {{ forloop.counter }}. </td>
            {% if obj.variations.all %}
            {% for item in obj.variations.all %}
          <td>  {{ item.title|capfirst }}
          {{ item.category|capfirst }} </td>
          
            <!-- {% if not forloop.last %} , {% endif %} -->
            {% endfor %}
          <td>  <font color="orange">Sufficient</font> </td>
           

            {% else %}
            <td> as in image</td>
            <td> as in image </td>
             <td>  <font color="orange">Sufficient</font> </td>
            {% endif %}
            
           
          
             {% else %}
         
           
            <td> {{ forloop.counter }}. </td>
            {% if obj.variations.all %}
            {% for item in obj.variations.all %}
          <td> {{ item.title|capfirst }} {{ item.category|capfirst }} </td>
            <!-- {% if not forloop.last %} , {% endif %} -->
            {% endfor %}
            {% else %}
            <td> as in image</td>
            <td> as in image </td>
             <td><font color="orange">Sufficient </font> </td>
            {% endif %}
       
          <td> <font color="red">({{ obj.quantity }} left only) </font> </td>
            </div>
           
            {% endif %}
            {% empty %}
            <td>
          <font color="red"> <p class='col-12'>  Sorry no products available.</p></font>
            </td>
            {% endfor %}
          </tr>
              </tbody>
            </table>  
        
         
        </div>
              </div>
         <hr/>
         
            <!-- <div class="card" style="width: 18rem"></div> -->
            <!-- {% if object.image %}
            <img src='{{ object.image.url }}' class='img-fluid' />
             {% endif %}   -->
            <!-- </div> -->


             <!-- {% for img in images %}
             <div class='col-xs-6 col-md-3'>
               <a href="#">
             <img class='img-thumbnail' src='{{ img.image.url }}' />
             </a>
             </div>
             {% endfor %} -->

             <!-- slider -->
    <div class='col-lg-12 col-md-8 col-sm-12' style="margin-top: 5rem;">
      <style>
        .checked {
          color: orange;
        }
      </style>
      <h3>Rating and Reviews (Overall rating: {{ object.rating }})</h3>
      <br/>
      {% if reviews.exists %}
      {% for rev in reviews %}
     <strong>{{ forloop.counter }}.</strong>

      
       {% if rev.email.profile_image %}
                <img src="{{ rev.email.profile_image.url }}" class="rounded-circle z-depth-0"
                  alt="avatar image" height="50" width="50" />
            
                  {% else %}
                  <img src='{% static "img/images.jpg" %}' class="rounded-circle z-depth-0"
                  alt="avatar image" height="50" width="50" />
      {% endif %}
      , {{ rev.email.full_name }} ,
      
       {% ifequal rev.rating 1 %}
       <span class="fa fa-star checked"></span>
        <span class="fa fa-star-o"></span>
        <span class="fa fa-star-o"></span>
        <span class="fa fa-star-o"></span>
        <span class="fa fa-star-o"></span>
        {% endifequal %}

        {% ifequal rev.rating 2 %}
       <span class="fa fa-star checked"></span>
      <span class="fa fa-star checked"></span>
      <span class="fa fa-star-o"></span>
      <span class="fa fa-star-o"></span>
      <span class="fa fa-star-o"></span>
        {% endifequal %}
       {% ifequal rev.rating 3 %}
       <span class="fa fa-star checked"></span>
      <span class="fa fa-star checked"></span>
      <span class="fa fa-star checked"></span>
      <span class="fa fa-star-o"></span>
      <span class="fa fa-star-o"></span>
        {% endifequal %}
       {% ifequal rev.rating 4 %}
       <span class="fa fa-star checked"></span>
      <span class="fa fa-star checked"></span>
      <span class="fa fa-star checked"></span>
      <span class="fa fa-star checked"></span>
      <span class="fa fa-star-o"></span>
        {% endifequal %}
      {% if rev.rating == 5 %}
      <span class="fa fa-star checked"></span>
      <span class="fa fa-star checked"></span>
      <span class="fa fa-star checked"></span>
      <span class="fa fa-star checked"></span>
      <span class="fa fa-star checked"></span>
        {% endif %}
        , {{ rev.timestamp|timesince }} ago

      
          <div class="container p-3 my-3 border" style="background-color: lightblue;">
            {{ rev.review }}
          </div>
          <hr/>
     {% endfor %}
        {% else %}

        <div class="container p-3 my-3 border" style="background-color: white;"> Not Reviewed yet! </div>
        {% endif %}

       
    </div>



        {% if similar_products %}
    <div class='col-lg-12 col-md-8 col-sm-12' style="margin-top: 2rem; background-color: white;">
    

       
        <h3 class="text-center" style="margin-top: 5rem;">Similar Products</h3>
              </br>
                       

   <!-- <section class="text-center"> -->

    <div class="row wow fadeIn">

          <!--Grid column-->
           {% for object in similar_products %}
         <div class="col-lg-3 col-md-3 col-sm-4 mb-4" style="display: flex;
        flex-wrap: wrap; flex-grow: 1;
        flex-basis: 100px; flex-shrink: inherit;

        justify-content: space-between;flex: calc(30% - 5em);" >
   
  
       {% include 'analytics/trending_card.html' with instance=object %}
    </div>
          
          
     {% endfor %}


    </div>
   
  </div>
   {% endif %}

</div>


</div>

 {% endblock %}

 